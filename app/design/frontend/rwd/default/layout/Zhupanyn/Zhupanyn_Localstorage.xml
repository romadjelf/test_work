<?xml version="1.0" encoding="utf-8"?>
<layout>
    <default>
        <reference name="right">
            <action method="unsetChild"><name>right.reports.product.viewed</name></action>
            <block type="zhupanyn_localstorage/product_viewed" before="right.permanent.callout" name="zh.localstorage.product.viewed" template="zhupanyn/localstorage/viewed.phtml" />
        </reference>
        <reference name="head">
            <action method="addJs"><script>zhupanyn/localstorage/main.js</script></action>
        </reference>
    </default>

    <catalog_category_layered_nochildren>
        <reference name="right">
            <action method="unsetChild"><name>left.reports.product.viewed</name></action>
        </reference>
    </catalog_category_layered_nochildren>

    <catalog_product_view>
        <reference name="content">
            <block type="zhupanyn_localstorage/storage" name="zh.localstorage.end" template="zhupanyn/localstorage/storage.phtml" after="product.info" />
        </reference>
    </catalog_product_view>
</layout>